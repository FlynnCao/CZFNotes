# 自定义组件说明

暂存分支 ：czf_master

组件位置：`src/components/`

`this`含义：指向嵌套以下组件的父组件实例

##  paginationLight (基于后端的分页)

>  改进自 PaginationMod  by zyj

待完善

##  FormDialog（一般表单对话框）

根据传入**表单模式**不同生成不同样式的表单

<img src="自定义组件说明.assets/image-20210407144336227.png" alt="image-20210407144336227" style="zoom: 50%;" />

### 基础用法

```html
<template>
<el-button @click="showChildDialog">Show</el-button>
  <form-dialog ref="commonDialog" :formPattern="formPattern" :formRule="formRule" :form="dialogFormData" @formData="handleFormDialogData">
    </form-dialog>
</template>
<script>
export  {
    methods:{
     showChildDialog() {
      	this.$refs.commonDialog.showDialog()
        this.$refs.commonDialog.setTitle('普通的对话框')
    },  
    },
	data(){
        return {
        dialogFormData: {
        name: '大型促销活动',
        author: '张三',
        date: '2020-04-01',
        time: '',
        pay: true,
        location: 'shanghai',
        country: ['中国', '美国'],
        substance: '社会主义',
        desc: '还不确定'
      },
      formPattern: [//表单格式
        {
          label: '活动名称',
          type: 'input',
          paramName: 'name',
        },
        {
          label: '活动日期',
          type: 'date-picker',
          paramName: 'date',
        },
        {
          label: '活动时间',
          type: 'time-picker',
          paramName: 'time',
        },
        {
          label: '是否到付',
          type: 'switch',
          paramName: 'pay',
        },
        {
          label: '参与地点',
          type: 'select',
          paramName: 'location',
          selection: [
            {
              label: '上海',
              value: 'shanghai'
            },
            {
              label: '大阪',
              value: 'osaka'
            },
            {
              label: '纽约',
              value: 'newyork'
            }
          ],
        },
        {
          label: '参与国家',
          type: 'muti-check',
          paramName: 'country',
          selection: [
            {
              label: '中国',
              value: 'china',
              checked: true
            },
            {
              label: '美国',
              value: 'usa',
              checked: true
            },
            {
              label: '韩国',
              value: 'korea',
              checked: false

            },
            {
              label: '日本',
              value: 'japan',
              checked: false
            }
          ],
        },
        {
          label: '国家性质',
          type: 'single-check',
          value: '社会主义',
          paramName: 'substance',
          selection: [
            {
              label: '社会主义'
            },
            {
              label: '资本主义'
            },
            {
              label: '其他'
            }
          ],
        },
        {
          label: '活动形式',
          type: 'textarea',
          paramName: 'desc',
        }
      ],
      formRule: {
        name: [{ required: true, message: '请输入活动名', trigger: 'blur' }],
        author: [{ required: true, message: '请输入发起者', trigger: 'blur' }],
        date: [{ type: 'date', required: true, message: '请选择日期', trigger: 'change' }],
        time: [{ type: 'date', required: true, message: '请选择日期', trigger: 'change' }],
        pay: [{ required: true, message: '请输入结算方式', trigger: 'blur' }],
        location: [{ required: true, message: '请输入举办地点', trigger: 'blur' }],
        country: [{ type: 'array', required: true, message: '请至少选择一个活动国家', trigger: 'change' }],
        substance: [{ required: true, message: '请输入国家性质', trigger: 'blur' }],
        desc: [{ required: true, message: '请输入描述', trigger: 'blur' }],
      },
​        }
​    }
}
</script>
```

### Events

| 事件名称 | 说明                       | 回调参数                                        |
| -------- | -------------------------- | ----------------------------------------------- |
| formData | 点击“提交”按钮并确认后触发 | 表单内容对象，键名为paramName，值为实际输入的值 |

> 父组件处理formData时应直接与服务器进行联络

### Attributes 

| 参数        | 说明         | 类型   | 是否必写 | 默认值 |
| ----------- | ------------ | ------ | -------- | ------ |
| formPattern | 表单格式     | Array  | 是       | 无     |
| title       | 对话框标题   | String | 否       | ''     |
| formRule    | 表单验证规则 | Object | 是       | 无     |
| form        | 表单数据     | Object | 是       | 无     |
### Functions

使用方法举例：`this.$refs.commonDialog.showDialog()`

| 方法名      | 说明             | 参数 | 参数类型 | 返回类型 |
| ----------- | ---------------- | ---- | -------- | -------- |
| showDialog  | 显示对话框       | -    | -        | -        |
| closeDialog | 关闭对话框       | -    | -        | -        |
| setTitle    | 设定对话框标题   | -    | String   | -        |
| getFormData | 获取表单填入的值 | -    | -        | Array    |
| reset       | 清空表单内容     | -    | -        | -        |
##  SelectiveTree（可选择树）

提供了树形控件的多选、全选和反选功能

<img src="自定义组件说明.assets/image-20210408182053822.png" alt="image-20210408182053822" style="zoom:50%;" />

### 基础用法

```html
<selective-tree :data="TreeData" :currentData="CurrentTreeData" :obj="{objectType:1, objectId:this.currentRole.RoleId}" ref="dbST"></selective-tree>

<srcipt>
export default{
   data(){
		return {
     menuTreeBody: [
        {
          paramName: 'text'
        }, {
          paramName: 'enCode'
        },
        {
          paramName: 'enCode'
        }
      ],
      menuTreeHead: [
        {
          label: '名称'
        },
        {
          label: '导航地址'
        },
        {
          label: '编码'
        }
      ],
    }
    }	    
}
</srcipt>
```

请求所有选中的id拼接str：`      let str = this.$refs.dbST.getCurrentKeyStr()`

重置树形控件状态：` this.$refs.dbST.reset()`

### Attributes

| 参数        | 说明                                                         | 类型          | 是否必写 | 默认值 |
| ----------- | ------------------------------------------------------------ | ------------- | -------- | ------ |
| data        | 树的数据                                                     | Array         | 是       | 无     |
| currentData | 树的已选择数据                                               | Array         | 是       | 无     |
| head        | 树表头格式                                                   | Object        | 是       | 无     |
| body        | 树条目内容格式                                               | Object        | 是       | 无     |
| tdWidth     | 树每列的宽度                                                 | Number        | 否       | 170    |
| height      | Tree的高度，默认为自动高度。如果 height 为 number 类型，单位 px；如果 height 为 string 类型，则这个高度会设置为 Table 的 style.height 的值，Table 的高度会受控于外部样式。 | Number/String | 否       | 500    |

> 不传入head不显示表头，不传入body只显示菜单标题

### Functions

| 名称             | 说明                                       | 参数 | 回调参数 |
| ---------------- | ------------------------------------------ | ---- | -------- |
| getCheckedKeyStr | 获取已选中的全部节点id拼接字符串           | -    | String   |
| reset            | 重置此树信息（成功修改菜单后的回调中使用） | -    | -        |

